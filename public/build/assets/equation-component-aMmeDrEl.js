import{r as s,j as t}from"./app-D0tGY9dM.js";import{o as g,e as h,S as q,R as j,j as b,K as N,V as x,i as S,P as _,y as k,W as v,X as $}from"./editor-BYv2-Q3p.js";/* empty css            */import"./index-BtVzuSVv.js";import"./createLucideIcon-ChOAi-eC.js";import"./index-Dc-jfdN_.js";import"./index-705hPj7j.js";import"./index-B-N1yRK0.js";import"./index-BStAVYXS.js";import"./dialog-DwHTjvPy.js";import"./x-CN7NPRRI.js";import"./loading-spinner-BrDIyboT.js";import"./loader-circle-B5b2RBVN.js";import"./send-B5DjOSro.js";import"./label-B4KF-rkq.js";import"./youtube-D7rVIVvm.js";import"./checkbox-DdKPwfYG.js";import"./textarea-DoTJowVI.js";import"./separator-Df4wLjte.js";function C({equation:n,setEquation:d,inline:u},e){const i=r=>{d(r.target.value)};return u&&e instanceof HTMLInputElement?t.jsxs("span",{className:"EquationEditor_inputBackground bg-background",children:[t.jsx("span",{className:"EquationEditor_dollarSign text-muted-foreground text-left",children:"$"}),t.jsx("input",{className:"EquationEditor_inlineEditor text-primary m-0 resize-none border-0 bg-inherit p-0 outline-none",value:n,onChange:i,autoFocus:!0,ref:e}),t.jsx("span",{className:"EquationEditor_dollarSign text-muted-foreground text-left",children:"$"})]}):t.jsxs("div",{className:"EquationEditor_inputBackground bg-background",children:[t.jsx("span",{className:"EquationEditor_dollarSign text-muted-foreground text-left",children:`$$
`}),t.jsx("textarea",{className:"EquationEditor_blockEditor text-primary m-0 w-full resize-none border-0 bg-inherit p-0 outline-none",value:n,onChange:i,ref:e}),t.jsx("span",{className:"EquationEditor_dollarSign text-muted-foreground text-left",children:`
$$`})]})}const y=s.forwardRef(C);function K({equation:n,inline:d,nodeKey:u}){const[e]=g(),i=h(),[r,f]=s.useState(n),[l,m]=s.useState(!1),E=s.useRef(null),p=s.useCallback(a=>{m(!1),e.update(()=>{const o=q(u);j(o)&&(o.setEquation(r),a&&o.selectNext(0,0))})},[e,r,u]);return s.useEffect(()=>{!l&&r!==n&&f(n)},[l,n,r]),s.useEffect(()=>{if(i)return l?b(e.registerCommand(S,a=>{const o=document.activeElement;return E.current!==o&&p(),!1},x),e.registerCommand(N,a=>{const o=document.activeElement;return E.current===o?(p(!0),!0):!1},x)):e.registerUpdateListener(({editorState:a})=>{a.read(()=>{const c=_();return k(c)&&c.has(u)&&c.getNodes().length===1})&&m(!0)})},[e,u,p,l,i]),t.jsx(t.Fragment,{children:l&&i?t.jsx(y,{equation:r,setEquation:f,inline:d,ref:E}):t.jsx(v,{onError:a=>e._onError(a),fallback:null,children:t.jsx($,{equation:r,inline:d,onDoubleClick:()=>{i&&m(!0)}})})})}export{K as default};

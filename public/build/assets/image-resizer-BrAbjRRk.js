import{r as b,j as a}from"./app-D0tGY9dM.js";import{M as E}from"./editor-BYv2-Q3p.js";import{B as Y}from"./createLucideIcon-ChOAi-eC.js";function z(d,g,p){return Math.min(Math.max(d,g),p)}const r={east:1,north:8,south:2,west:4};function S({onResizeStart:d,onResizeEnd:g,buttonRef:p,imageRef:w,maxWidth:x,editor:v,showCaption:P,setShowCaption:N,captionsEnabled:C}){const y=b.useRef(null),m=b.useRef({priority:"",value:"default"}),f=b.useRef({currentHeight:0,currentWidth:0,direction:0,isResizing:!1,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),c=v.getRootElement(),R=x||(c!==null?c.getBoundingClientRect().width-20:100),M=c!==null?c.getBoundingClientRect().height-20:100,W=100,X=100,$=t=>{const s=t===r.east||t===r.west,e=t===r.north||t===r.south,u=t&r.north&&t&r.west||t&r.south&&t&r.east,n=s?"ew":e?"ns":u?"nwse":"nesw";c!==null&&c.style.setProperty("cursor",`${n}-resize`,"important"),document.body!==null&&(document.body.style.setProperty("cursor",`${n}-resize`,"important"),m.current.value=document.body.style.getPropertyValue("-webkit-user-select"),m.current.priority=document.body.style.getPropertyPriority("-webkit-user-select"),document.body.style.setProperty("-webkit-user-select","none","important"))},L=()=>{c!==null&&c.style.setProperty("cursor","text"),document.body!==null&&(document.body.style.setProperty("cursor","default"),document.body.style.setProperty("-webkit-user-select",m.current.value,m.current.priority))},l=(t,s)=>{if(!v.isEditable())return;const e=w.current,u=y.current;if(e!==null&&u!==null){t.preventDefault();const{width:n,height:h}=e.getBoundingClientRect(),i=E(e),o=f.current;o.startWidth=n,o.startHeight=h,o.ratio=n/h,o.currentWidth=n,o.currentHeight=h,o.startX=t.clientX/i,o.startY=t.clientY/i,o.isResizing=!0,o.direction=s,$(s),d(),u.classList.add("touch-action-none"),e.style.height=`${h}px`,e.style.width=`${n}px`,document.addEventListener("pointermove",H),document.addEventListener("pointerup",j)}},H=t=>{const s=w.current,e=f.current,u=e.direction&(r.east|r.west),n=e.direction&(r.south|r.north);if(s!==null&&e.isResizing){const h=E(s);if(u&&n){let i=Math.floor(e.startX-t.clientX/h);i=e.direction&r.east?-i:i;const o=z(e.startWidth+i,W,R),D=o/e.ratio;s.style.width=`${o}px`,s.style.height=`${D}px`,e.currentHeight=D,e.currentWidth=o}else if(n){let i=Math.floor(e.startY-t.clientY/h);i=e.direction&r.south?-i:i;const o=z(e.startHeight+i,X,M);s.style.height=`${o}px`,e.currentHeight=o}else{let i=Math.floor(e.startX-t.clientX/h);i=e.direction&r.east?-i:i;const o=z(e.startWidth+i,W,R);s.style.width=`${o}px`,e.currentWidth=o}}},j=()=>{const t=w.current,s=f.current,e=y.current;if(t!==null&&e!==null&&s.isResizing){const u=s.currentWidth,n=s.currentHeight;s.startWidth=0,s.startHeight=0,s.ratio=0,s.startX=0,s.startY=0,s.currentWidth=0,s.currentHeight=0,s.isResizing=!1,e.classList.remove("touch-action-none"),L(),g(u,n),document.removeEventListener("pointermove",H),document.removeEventListener("pointerup",j)}};return a.jsxs("div",{ref:y,children:[!P&&C&&a.jsx(Y,{className:"image-caption-button absolute bottom-1 left-1/2 -translate-x-1/2",ref:p,variant:"outline",onClick:()=>{N(!P)},children:"Add Caption"}),a.jsx("div",{className:"image-resizer image-resizer-n bg-primary absolute -top-2.5 left-1/2 h-3 w-3 -translate-x-1/2 cursor-ns-resize",onPointerDown:t=>{l(t,r.north)}}),a.jsx("div",{className:"image-resizer image-resizer-ne bg-primary absolute -top-2.5 -right-2.5 h-3 w-3 cursor-nesw-resize",onPointerDown:t=>{l(t,r.north|r.east)}}),a.jsx("div",{className:"image-resizer image-resizer-e bg-primary absolute top-1/2 -right-2.5 h-3 w-3 -translate-y-1/2 cursor-ew-resize",onPointerDown:t=>{l(t,r.east)}}),a.jsx("div",{className:"image-resizer image-resizer-se bg-primary absolute -right-2.5 -bottom-2.5 h-3 w-3 cursor-nwse-resize",onPointerDown:t=>{l(t,r.south|r.east)}}),a.jsx("div",{className:"image-resizer image-resizer-s bg-primary absolute -bottom-2.5 left-1/2 h-3 w-3 -translate-x-1/2 cursor-ns-resize",onPointerDown:t=>{l(t,r.south)}}),a.jsx("div",{className:"image-resizer image-resizer-sw bg-primary absolute -bottom-2.5 -left-2.5 h-3 w-3 cursor-nesw-resize",onPointerDown:t=>{l(t,r.south|r.west)}}),a.jsx("div",{className:"image-resizer image-resizer-w bg-primary absolute top-1/2 -left-2.5 h-3 w-3 -translate-y-1/2 cursor-ew-resize",onPointerDown:t=>{l(t,r.west)}}),a.jsx("div",{className:"image-resizer image-resizer-nw bg-primary absolute -top-2.5 -left-2.5 h-3 w-3 cursor-nwse-resize",onPointerDown:t=>{l(t,r.north|r.west)}})]})}export{S as I};
